# 后端服务集成测试说明

## ✅ 已完成的集成

### 1. Contentful 博客集成
- ✅ 已配置 Contentful API
- ✅ 支持中英文双语（独立字段）
- ✅ 首页 Insights Section 显示最新 3 篇文章
- ✅ Insights 页面显示所有文章
- ✅ 自动根据语言切换内容

### 2. Tally 表单集成
- ✅ Contact 页面：已替换为 Tally 表单嵌入
- ✅ Footer 订阅：已替换为 Tally 表单嵌入
- ✅ 使用统一的 TallyForm 组件

---

## 🧪 本地测试

### 启动开发服务器

```bash
cd sweekli-website
npm run dev
```

服务器将在 `http://localhost:5173` 启动（或显示的其他端口）

### 测试 Contentful 博客

1. **访问首页** (`http://localhost:5173`)
   - 滚动到 "Latest Market Insights" 部分
   - 应该显示从 Contentful 加载的最新 3 篇文章
   - 切换语言（中/英），内容应该相应变化

2. **访问 Insights 页面** (`http://localhost:5173/insights`)
   - 应该显示所有从 Contentful 加载的文章
   - 切换语言，文章标题和内容应该相应变化

3. **检查浏览器控制台**
   - 打开开发者工具（F12）
   - 查看 Console 标签
   - 如果有 Contentful API 错误，会显示在控制台

### 测试 Tally 表单

1. **Contact 页面** (`http://localhost:5173/contact`)
   - 应该显示 Tally 表单嵌入
   - 填写表单并提交
   - 检查 Tally 后台是否收到提交

2. **Footer 订阅** (任意页面底部)
   - 滚动到页面底部
   - 在 Newsletter 部分应该看到 Tally 表单
   - 填写邮箱并提交
   - 检查 Tally 后台是否收到提交

---

## 📝 Contentful 内容迁移

### 迁移现有 3 篇博客到 Contentful

1. **安装依赖**（如果还没有）：
```bash
npm install contentful-management
```

2. **运行迁移脚本**：
```bash
node scripts/migrate-to-contentful.js
```

3. **手动上传图片**：
   - 脚本会创建文章，但图片需要手动在 Contentful 中上传
   - 登录 Contentful 后台
   - 为每篇文章上传对应的图片
   - 将图片关联到文章的 `image` 字段

### Contentful 字段结构

确保你的 Contentful `blogPost` Content Type 包含以下字段：

- `titleEn` (Short text) - 英文标题
- `titleZh` (Short text) - 中文标题
- `excerptEn` (Long text) - 英文摘要
- `excerptZh` (Long text) - 中文摘要
- `date` (Date) - 发布日期
- `categoryEn` (Short text) - 英文分类
- `categoryZh` (Short text) - 中文分类
- `slug` (Short text, unique) - URL 别名
- `image` (Media) - 文章图片
- `contentEn` (Rich text, optional) - 英文正文
- `contentZh` (Rich text, optional) - 中文正文

---

## 🔧 配置检查

### Contentful 配置
文件：`src/config/contentful.ts`
- ✅ Space ID: `wbpsfgfg62v2`
- ✅ Access Token: `DN_cZeDWpTQcwTgML-lYyvDkLOemgEAOcQXsIlcACsk`
- ✅ Content Type: `blogPost`

### Tally 配置
文件：`src/components/common/TallyForm.vue`
- ✅ Form ID: `lbqLJB`
- ✅ 使用位置：
  - Contact 页面
  - Footer Newsletter

---

## ⚠️ 注意事项

1. **Contentful API 限制**：
   - Contentful 有 API 调用限制
   - 如果遇到 429 错误（Too Many Requests），需要等待一段时间

2. **Tally 表单**：
   - 确保 Tally 表单 ID 正确
   - 如果需要在 Footer 使用不同的表单（只有邮箱），需要在 Tally 创建新表单并更新 `form-id`

3. **图片路径**：
   - Contentful 中的图片会自动使用 CDN URL
   - 如果图片未上传，会使用默认占位图

4. **语言切换**：
   - 切换语言时会自动重新加载文章
   - 确保 Contentful 中有对应语言的字段内容

---

## 🐛 故障排除

### Contentful 文章不显示

1. 检查浏览器控制台是否有错误
2. 确认 Contentful Space ID 和 Access Token 正确
3. 确认 Content Type ID 为 `blogPost`
4. 确认 Contentful 中有已发布的内容

### Tally 表单不显示

1. 检查网络连接
2. 确认 Tally 表单 ID 正确
3. 检查浏览器控制台是否有 JavaScript 错误
4. 确认 Tally 脚本已正确加载

### 图片不显示

1. 检查 Contentful 中图片是否已上传
2. 检查图片是否关联到文章的 `image` 字段
3. 检查浏览器控制台是否有图片加载错误

---

## 📞 需要帮助？

如果遇到问题：
1. 检查浏览器控制台的错误信息
2. 检查网络请求（Network 标签）
3. 确认所有配置信息正确
4. 查看 Contentful 和 Tally 的后台是否有数据

